@inject BarberchainDbContext Context
@using MudBlazor

@if (OrderList != null && OrderList.Count > 0)
{
    <MudPaper Elevation="3" Class="p-4 rounded-lg">
        <MudContainer Style="display:flex; padding-top:1rem;">
            <MudContainer Style="display:flex; flex-direction:column; align-items:flex-start;">
                @foreach (var o in OrderList)
                {
                    <MudDivider></MudDivider>
                    <MudStack>
                        <MudText>@o.AppointedTime</MudText>
                        <MudText>@o.Status</MudText>
                        <MudText>@o.OrderTime</MudText>
                        <MudText>@o.Method</MudText>
                        <MudText>@string.Join(", ", o.OrderJobs.Select(oj => oj.Job).Where(j => j != null).Select(j => j.Name))</MudText>
                    </MudStack>
                }
            </MudContainer>
        </MudContainer>
    </MudPaper>
}
else
{
    <MudPaper Elevation="3" Class="p-4 rounded-lg">
        <MudText>
            No orders found for your account
        </MudText>
    </MudPaper>
}

@code {
    [Parameter]
    public int id { get; set; }

    private List<Order> OrderList { get; set; }

    protected override async Task OnInitializedAsync()
    {
        OrderList = await Context.Orders
            .Include(o => o.OrderJobs)
            .Where(o => o.AccountId == id).ToListAsync();
    }
}